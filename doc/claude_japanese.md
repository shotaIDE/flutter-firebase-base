# コーディングガイド

## 絶対に守るべきルール

### フォーマッタの適用

コード修正した後は、必ずフォーマッタを適用する。
実行コマンドは以下の通り。

```bash
dart format path/to/your/file.dart
```

### Linter の自動修正の適用

コード修正をした後は、必ず Linter の自動修正を適用する。
実行コマンドは以下の通り。

```bash
dart fix --apply
```

### Linter の警告の解決

コード修正した後は、Linter やコンパイラの警告を必ず確認する。
警告が発生している場合は、解決する。

### テストがパスしていることの確認と修正

コード修正時は必ずユニットテストを実行し、全てのテストが通過することを確認する。

### ユニットテストの追加

コード修正を行った場合は、ユニットテストを追加する余地がないかを検討する。
もし、ユニットテストを追加できる場合は、必ず追加する。

### リファクタリング

コード修正を行った場合は、リファクタリングの余地がないかを検討する。
もし、リファクタリングできる場合は、必ずリファクタリングを行う。

### 不要コードの削除

コード修正を行った場合は、不要なコードが残っていないかを確認する。
もし、不要なコードが残っている場合は、即時削除する。

### SDK の関数などの妥当な利用

今までコードベースに利用されていなかった新しい SDK の関数などを新しく利用する場合は、以下を確認する。

- 公式ドキュメントなどを確認し、シンプルな利用方法になっているかを確認する。もし、複雑な利用方法になっている場合は、シンプルな利用方法に修正する。

# アーキテクチャ

本プロジェクトは、iOS と Android のアプリケーションであり、フロントエンドとバックエンドのコードを含む。

## クライアントアプリ

`client/` は、Flutter による iOS と Android クライアントアプリのコードを配置する。

- [`./android/`](/client/android/): Android 専用のプロダクトコードやプロジェクト設定
- [`./ios/`](/client/ios/): iOS 専用のプロダクトコードやプロジェクト設定
- [`./lib/`](/client/lib/): OS 間で共通のプロダクトコード
  - [`./data/`](/client/lib/data/): 情報の保持・取得や、OS レイヤーとのやりとり
    - [`./definition/`](/client/lib/data/definition/): 情報の保持・取得や、OS レイヤーとのやりとりに利用する共通化された定義
    - [`./model/`](/client/lib/data/model/): ドメインモデル。UI に依存しない純粋なデータ構造や、UI に依存しない `Exception`、`Error` などを配置する。
    - [`./repository/`](/client/lib/data/repository/): Repository。具体的な向き先を抽象化しつつ、情報の保持・取得を行う処理の定義
    - [`./service/`](/client/lib/data/service/): Service。OS や Firebase との接続を定義
  - [`./ui/`](/client/lib/ui/): 画面描画や表示ロジックの定義
    - [`./component/`](/client/lib/ui/component/): 画面間で共通化された UI 部品の定義
    - [`./feature/`](/client/lib/ui/feature/): 画面と画面ロジック。カテゴリーごとのサブフォルダーが存在する。
- [`./test/`](/client/test/): ユニットテスト、ウィジェットテスト

本アプリでは、Swift Package Manager(SPM) を有効化しており、CocoaPods と併用している。
SPM は以下のコマンドにより、Flutter 本体で有効化している。

```bash
flutter config --enable-swift-package-manager
```

SPM はベータ版機能であるため、ビルドなどで問題が発生することがある。
その際は、Flutter の報告されている Issue を調査したり、未知の問題が発生している可能性があることを考慮するなどにより、トラブルシューティングを行う。

## インフラ

`infra/` は、インフラ構成とバックエンドのコードを配置する。
